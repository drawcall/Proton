<!DOCTYPE html>
<html>
<head>
    <title>Proton with Pixi.js v8 Example</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
            width: 100%;
            height: 100%;
        }
        #canvas {
            width: 100%;
            height: 100%;
        }
    </style>
    <!-- Import Pixi.js v8 -->
    <script src="https://pixijs.download/v8.0.0/pixi.min.js"></script>
    <!-- Import Proton - Use proton.web.js instead of proton.js -->
    <script src="../build/proton.web.js"></script>
</head>
<body>
    <div id="canvas"></div>

    <script>
        // Initialize Pixi.js v8 application (async)
        (async function() {
            // Create Pixi Application with v8
            const app = new PIXI.Application();
            
            // Initialize the application
            await app.init({
                resizeTo: window,
                background: '#000',
                antialias: true
            });
            
            // Add the view to the DOM
            document.getElementById('canvas').appendChild(app.canvas);
            
            // Create a Proton instance - use Proton directly without window.
            const proton = new Proton();
            
            // Create an emitter
            const emitter = new Proton.Emitter();
            emitter.rate = new Proton.Rate(new Proton.Span(10000, 10000), new Proton.Span(0.01, 0.05));
            
            // Set emitter position to center of screen
            emitter.p.x = app.screen.width / 2;
            emitter.p.y = app.screen.height / 2;
            
            // Configure the particles
            emitter.addInitialize(new Proton.Mass(1));
            emitter.addInitialize(new Proton.Radius(new Proton.Span(10, 30)));
            emitter.addInitialize(new Proton.Life(1, 3));
            emitter.addInitialize(new Proton.Velocity(new Proton.Span(2, 4), new Proton.Span(0, 360), 'polar'));
            
            // Add behaviors
            emitter.addBehaviour(new Proton.Color(['#FF0026', '#FFFF00', '#00FF35', '#00FFFF', '#0000FF']));
            emitter.addBehaviour(new Proton.Alpha(1, 0));
            emitter.addBehaviour(new Proton.Scale(1, 0.5));
            
            // Add the Pixi renderer to Proton
            const renderer = new Proton.PixiRenderer(app.stage);
            proton.addRenderer(renderer);
            
            // Start the emitter
            emitter.emit();
            proton.addEmitter(emitter);
            
            // Update Proton in animation loop
            app.ticker.add(() => {
                proton.update();
            });
            
            // Handle window resize
            window.addEventListener('resize', () => {
                emitter.p.x = app.screen.width / 2;
                emitter.p.y = app.screen.height / 2;
            });
        })();
    </script>
</body>
</html> 